app:
  envFrom:
    - secretRef:
        name: app
  env:
    - name: NEXTAUTH_URL
      value: https://{{ .Values.global.host }}
  probesPath: /healthz
  replicas: 2
  imagePackage: app

hasura:
  ~needs: [create-db]
  envFrom:
    - secretRef:
        name: hasura
    - secretRef:
        name: pg-user
    - configMapRef:
        name: hasura-configmap
  resources:
    limits:
      cpu: 500m
      memory: 1024Mi
    requests:
      cpu: 250m
      memory: 512Mi
  replicas: 2

jobs:
  runs:
    create-db:
      use: create-db
