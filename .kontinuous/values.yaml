app:
  envFrom:
    - secretRef:
        name: app
  env:
    - name: NEXTAUTH_URL
      value: https://{{ .Values.global.host }}
  probesPath: /healthz
  imagePackage: app
  resources:
    requests:
      cpu: 5m
      memory: 128Mi
    limits:
      cpu: 10m
      memory: 256Mi
  autoscale:
    enabled: true
    minReplicas: 2

hasura:
  ~needs: [create-db]
  envFrom:
    - secretRef:
        name: hasura
    - secretRef:
        name: pg-user
    - configMapRef:
        name: hasura-configmap
  resources:
    requests:
      cpu: 25m
      memory: 512Mi
    limits:
      cpu: 50m
      memory: 1024Mi
  autoscale:
    enabled: true
    minReplicas: 2

jobs:
  runs:
    create-db:
      use: create-db
